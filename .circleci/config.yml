version: 2
jobs:
  lint:
    docker:
      - image: alpine/helm
    steps:
      - checkout
      - run:
          name: Run helm lint for all chart directories
          command: |
            for c in $(find ./mercari -type d -maxdepth 1 -mindepth 1)
            do
              helm lint ${c}
            done
  sync:
    docker:
      - image: google/cloud-sdk
    steps:
      - checkout
      - run:
          name: sync
          command: |
            .circleci/repo-sync.sh mercari
            
workflows:
  version: 2
  lint:
    jobs:
      - lint
  sync:
    jobs:
      - sync
